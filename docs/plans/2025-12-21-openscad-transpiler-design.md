# OpenSCAD to Manifold-3D Transpiler Implementation Plan

**Date:** 2025-12-21
**Status:** Ready for Implementation
**Prerequisite:** Exploration complete (see `2025-12-21-openscad-transpiler-exploration.md`)

---

## 1. Overview

This plan implements a transpiler that converts OpenSCAD code (generated by AI) into Manifold-3D JavaScript code executable by the existing worker. The transpiler enables AI to generate OpenSCAD (a well-documented, stable 3D modeling language) instead of raw Manifold JavaScript, improving generation quality and reducing hallucinations.

### Key Benefits
- AI can leverage extensive OpenSCAD training data
- Constrained subset prevents unsupported feature usage
- Parse errors provide actionable context for AI retry
- Worker interface remains unchanged

### Architecture

```
AI generates OpenSCAD
        |
        v
+-------------------+
|      Lexer        | Tokenizes source with line/column info
+-------------------+
        |
        v
+-------------------+
|      Parser       | Recursive descent -> AST
+-------------------+
        |
        v
+-------------------+
|    Transpiler     | AST -> Manifold JavaScript string
+-------------------+
        |
        v
Worker executes JavaScript (unchanged)
```

---

## 2. Approaches Considered

### Approach A: Hand-Written Recursive Descent Parser (RECOMMENDED)
**Trade-offs:**
- (+) Full control over error messages with line/column info
- (+) No external dependencies
- (+) Easy to limit to supported subset
- (+) Familiar pattern in this codebase
- (-) More initial implementation effort

### Approach B: PEG.js or Nearley Parser Generator
**Trade-offs:**
- (+) Grammar-based, formally defined
- (-) External dependency
- (-) Less control over error messages
- (-) Learning curve for grammar syntax
- (-) Harder to customize for AI retry context

### Approach C: Regex-Based Parsing
**Trade-offs:**
- (+) Quick to implement
- (-) Fragile for nested structures
- (-) Poor error messages
- (-) Difficult to maintain

**Recommendation:** Approach A - Hand-written recursive descent parser provides the best balance of control, error quality, and maintainability for this constrained use case.

---

## 3. Architecture Notes

### Supported OpenSCAD Subset

| Category | Supported Operations |
|----------|---------------------|
| **Primitives** | `cube`, `sphere`, `cylinder`, `circle`, `square`, `polygon` |
| **Transforms** | `translate`, `rotate`, `scale`, `mirror` |
| **Booleans** | `union`, `difference`, `intersection` |
| **Extrusion** | `linear_extrude`, `rotate_extrude` |
| **Special** | `$fn` (clamped 16-128, default 32) |

### NOT Supported (Explicitly Rejected)
- Control flow: `for`, `if`, `else`
- Functions/modules: `module`, `function`
- Variables: `x = 5;`
- Advanced operations: `hull()`, `minkowski()`, `import()`, `use`
- Comments in output (stripped during lexing)

### Token Types
```typescript
type TokenType =
  // Literals
  | 'NUMBER' | 'IDENTIFIER' | 'STRING'
  // Punctuation
  | 'LPAREN' | 'RPAREN' | 'LBRACE' | 'RBRACE' | 'LBRACKET' | 'RBRACKET'
  | 'COMMA' | 'SEMICOLON' | 'EQUALS'
  // Special
  | 'SPECIAL_VAR'  // $fn, $fa, $fs
  | 'EOF'
```

### AST Node Types
```typescript
type ASTNode =
  | ProgramNode
  | PrimitiveCallNode      // cube([10,10,10], center=true)
  | TransformNode          // translate([1,2,3]) { ... }
  | BooleanOpNode          // union() { ... }
  | ExtrudeNode            // linear_extrude(height=10) { ... }
  | SpecialVarAssignNode   // $fn = 32;
```

### Manifold API Mapping

| OpenSCAD | Manifold JavaScript |
|----------|-------------------|
| `cube([x,y,z], center=true)` | `M.Manifold.cube([x,y,z], true)` |
| `sphere(r=5, $fn=32)` | `M.Manifold.sphere(5, 32)` |
| `cylinder(h=10, r=5)` | `M.Manifold.cylinder(10, 5, 5, 32, false)` |
| `cylinder(h=10, r1=5, r2=3)` | `M.Manifold.cylinder(10, 5, 3, 32, false)` |
| `cylinder(h=10, d=10)` | `M.Manifold.cylinder(10, 5, 5, 32, false)` (d/2) |
| `translate([x,y,z])` | `.translate([x,y,z])` |
| `rotate([x,y,z])` | `.rotate([x,y,z])` |
| `scale([x,y,z])` | `.scale([x,y,z])` |
| `mirror([x,y,z])` | `.mirror([x,y,z])` |
| `union() { a; b; }` | `a.add(b)` or `M.Manifold.union([a, b])` |
| `difference() { a; b; }` | `a.subtract(b)` |
| `intersection() { a; b; }` | `a.intersect(b)` |
| `linear_extrude(height=h)` | `M.Manifold.extrude(polygon, h)` |
| `rotate_extrude(angle=360)` | `M.Manifold.revolve(polygon, 32, 360)` |

---

## 4. Parallel Execution Groups

```
PHASE 1 (Foundation) - All tasks parallelizable
+------------------------------------------+
| Task 1.1: Types (tokens, AST)            |
| Task 1.2: Error classes                  |
+------------------------------------------+

PHASE 2 (Lexer) - Sequential within phase
+------------------------------------------+
| Task 2.1: Lexer tests                    |
| Task 2.2: Lexer implementation           |
+------------------------------------------+

PHASE 3 (Parser) - Sequential within phase
+------------------------------------------+
| Task 3.1: Parser tests                   |
| Task 3.2: Parser implementation          |
+------------------------------------------+

PHASE 4 (Transpiler) - Sequential within phase
+------------------------------------------+
| Task 4.1: Transpiler tests               |
| Task 4.2: Transpiler implementation      |
+------------------------------------------+

PHASE 5 (Integration) - Sequential within phase
+------------------------------------------+
| Task 5.1: Integration tests              |
| Task 5.2: Public exports (index.ts)      |
| Task 5.3: OpenSCAD prompt template       |
| Task 5.4: Service integration            |
+------------------------------------------+
```

---

## 5. Sequential Dependencies

```
Phase 1 ──┬──> Phase 2 ──> Phase 3 ──> Phase 4 ──> Phase 5
          │
     Types & Errors
     (no dependencies)
```

Within each phase, test tasks must complete before implementation tasks.

---

## 6. Detailed Task List

## Phase 1: Foundation Types [PARALLEL-GROUP-A]

### Task 1.1: Define Token and AST Types
- **Type**: Implementation
- **Parallelizable**: Yes (with Task 1.2)
- **File**: `src/openscad/types.ts`
- **Description**: Define TypeScript types for tokens (with line/column positions) and AST nodes for the supported OpenSCAD subset.
- **Acceptance Criteria**:
  - [ ] `Token` interface with `type`, `value`, `line`, `column` fields
  - [ ] `TokenType` union covering all supported tokens
  - [ ] `Position` interface for error reporting
  - [ ] AST node interfaces: `ProgramNode`, `PrimitiveCallNode`, `TransformNode`, `BooleanOpNode`, `ExtrudeNode`, `SpecialVarAssignNode`
  - [ ] `ASTNode` discriminated union type
  - [ ] Named argument types for primitives (e.g., `CubeArgs`, `CylinderArgs`)
  - [ ] No runtime code, only type definitions
- **Estimated Complexity**: Small

### Task 1.2: Define Error Classes
- **Type**: Implementation
- **Parallelizable**: Yes (with Task 1.1)
- **File**: `src/openscad/errors.ts`
- **Description**: Create error classes following the pattern from `src/cadquery/errors.ts`, with line/column info for AI retry context.
- **Acceptance Criteria**:
  - [ ] `OpenSCADError` base class extending `Error`
  - [ ] `OpenSCADLexError` with `line`, `column`, `found` properties
  - [ ] `OpenSCADParseError` with `line`, `column`, `found`, `expected` properties
  - [ ] `OpenSCADTranspileError` with optional `node` reference
  - [ ] `toRetryContext()` method on parse errors returning formatted string for AI
  - [ ] All errors have descriptive `name` property
- **Estimated Complexity**: Small

---

## Phase 2: Lexer [SEQUENTIAL]

### Task 2.1: Write Lexer Tests [BLOCKER]
- **Type**: Test
- **Parallelizable**: No (depends on Task 1.1, 1.2)
- **File**: `src/openscad/__tests__/Lexer.test.ts`
- **Description**: Define comprehensive test cases for the lexer covering all token types, edge cases, and error conditions.
- **Acceptance Criteria**:
  - [ ] Test tokenizing primitive keywords: `cube`, `sphere`, `cylinder`, `circle`, `square`, `polygon`
  - [ ] Test tokenizing transform keywords: `translate`, `rotate`, `scale`, `mirror`
  - [ ] Test tokenizing boolean keywords: `union`, `difference`, `intersection`
  - [ ] Test tokenizing extrusion keywords: `linear_extrude`, `rotate_extrude`
  - [ ] Test tokenizing numbers: integers, floats, negative numbers, scientific notation
  - [ ] Test tokenizing punctuation: `()`, `{}`, `[]`, `,`, `;`, `=`
  - [ ] Test tokenizing special variables: `$fn`, `$fa`, `$fs`
  - [ ] Test tokenizing `true`, `false` as identifiers/booleans
  - [ ] Test tokenizing named arguments: `center=true`, `height=10`
  - [ ] Test skipping single-line comments: `// comment`
  - [ ] Test skipping multi-line comments: `/* comment */`
  - [ ] Test line/column tracking across multiple lines
  - [ ] Test error on invalid characters with correct position
  - [ ] Test error on unterminated multi-line comment
  - [ ] Test empty input produces only EOF token
- **Estimated Complexity**: Medium

### Task 2.2: Implement Lexer [CRITICAL-PATH]
- **Type**: Implementation
- **Parallelizable**: No (depends on Task 2.1)
- **File**: `src/openscad/Lexer.ts`
- **Description**: Implement tokenizer that converts OpenSCAD source into tokens with line/column positions.
- **Acceptance Criteria**:
  - [ ] All tests from Task 2.1 pass
  - [ ] `lex(source: string): Token[]` function exported
  - [ ] Tokens include accurate `line` and `column` (1-indexed)
  - [ ] Comments stripped (not tokenized)
  - [ ] Whitespace consumed but not tokenized
  - [ ] `OpenSCADLexError` thrown for invalid input with position
  - [ ] EOF token appended at end
  - [ ] No hardcoded values for error messages
- **Estimated Complexity**: Medium

---

## Phase 3: Parser [SEQUENTIAL]

### Task 3.1: Write Parser Tests [BLOCKER]
- **Type**: Test
- **Parallelizable**: No (depends on Task 2.2)
- **File**: `src/openscad/__tests__/Parser.test.ts`
- **Description**: Define test cases for recursive descent parser covering all supported constructs and error conditions.
- **Acceptance Criteria**:
  - [ ] Test parsing `cube([10,20,30])` - positional array argument
  - [ ] Test parsing `cube([10,20,30], center=true)` - with named argument
  - [ ] Test parsing `cube(10)` - single number shorthand
  - [ ] Test parsing `sphere(r=5)` - named radius
  - [ ] Test parsing `sphere(d=10)` - diameter (converted to radius)
  - [ ] Test parsing `cylinder(h=10, r=5)` - basic cylinder
  - [ ] Test parsing `cylinder(h=10, r1=5, r2=3)` - cone
  - [ ] Test parsing `cylinder(h=10, d=10)` - diameter form
  - [ ] Test parsing `circle(r=5)` and `square([10,20])`
  - [ ] Test parsing `polygon(points=[[0,0],[10,0],[5,10]])`
  - [ ] Test parsing `translate([1,2,3]) { cube([10,10,10]); }`
  - [ ] Test parsing chained transforms: `translate(...) rotate(...) { ... }`
  - [ ] Test parsing `union() { cube(...); sphere(...); }`
  - [ ] Test parsing `difference() { ... }` with multiple children
  - [ ] Test parsing nested booleans: `union() { difference() { ... } ... }`
  - [ ] Test parsing `linear_extrude(height=10) { square([5,5]); }`
  - [ ] Test parsing `linear_extrude(height=10, twist=45, scale=0.5)`
  - [ ] Test parsing `rotate_extrude(angle=360, $fn=64)`
  - [ ] Test parsing `$fn = 32;` assignment
  - [ ] Test parsing semicolons: required after primitives, optional after blocks
  - [ ] Test error for unsupported `for` loop with position info
  - [ ] Test error for unsupported `if` statement with position info
  - [ ] Test error for unsupported `module` definition
  - [ ] Test error for unsupported variable assignment (`x = 5;`)
  - [ ] Test error for missing closing brace with position
  - [ ] Test error for missing closing parenthesis with position
  - [ ] Test `expected` field contains helpful token description
- **Estimated Complexity**: Large (break into sub-tasks if needed)

### Task 3.2: Implement Parser [CRITICAL-PATH]
- **Type**: Implementation
- **Parallelizable**: No (depends on Task 3.1)
- **File**: `src/openscad/Parser.ts`
- **Description**: Implement recursive descent parser that builds AST from tokens.
- **Acceptance Criteria**:
  - [ ] All tests from Task 3.1 pass
  - [ ] `parse(source: string): ProgramNode` function exported
  - [ ] Internally calls lexer, then parses token stream
  - [ ] Recursive descent with clear grammar functions: `parseProgram`, `parseStatement`, `parsePrimitive`, `parseTransform`, `parseBoolean`, `parseExtrude`
  - [ ] Named and positional arguments correctly parsed
  - [ ] `$fn` assignments tracked for context
  - [ ] `OpenSCADParseError` thrown with `line`, `column`, `found`, `expected`
  - [ ] Unsupported features (for, if, module, variables) rejected with helpful messages
  - [ ] No infinite loops on malformed input
- **Estimated Complexity**: Large

---

## Phase 4: Transpiler [SEQUENTIAL]

### Task 4.1: Write Transpiler Tests [BLOCKER]
- **Type**: Test
- **Parallelizable**: No (depends on Task 3.2)
- **File**: `src/openscad/__tests__/Transpiler.test.ts`
- **Description**: Define test cases for AST to Manifold JavaScript code generation.
- **Acceptance Criteria**:
  - [ ] Test `cube([10,20,30], center=true)` -> `M.Manifold.cube([10,20,30], true)`
  - [ ] Test `cube(10)` -> `M.Manifold.cube([10,10,10], false)` (expand shorthand)
  - [ ] Test `sphere(r=5, $fn=48)` -> `M.Manifold.sphere(5, 48)`
  - [ ] Test `sphere(r=5)` uses default 32 segments
  - [ ] Test `cylinder(h=10, r=5)` -> `M.Manifold.cylinder(10, 5, 5, 32, false)`
  - [ ] Test `cylinder(h=10, r1=5, r2=3, center=true)` -> correct Manifold call
  - [ ] Test `cylinder(h=10, d=10)` -> radius = 5 (d/2)
  - [ ] Test `translate([1,2,3]) { cube([10,10,10]); }` -> `.translate([1,2,3])`
  - [ ] Test `rotate([0,0,45]) { ... }` -> `.rotate([0,0,45])`
  - [ ] Test `scale(2) { ... }` -> `.scale([2,2,2])` (expand scalar)
  - [ ] Test `mirror([1,0,0]) { ... }` -> `.mirror([1,0,0])`
  - [ ] Test chained transforms apply in correct order (outer-to-inner)
  - [ ] Test `union() { a; b; }` -> `const _u1 = a.add(b); return _u1;` or similar
  - [ ] Test `difference() { a; b; c; }` -> `a.subtract(b).subtract(c)`
  - [ ] Test `intersection() { a; b; }` -> `a.intersect(b)`
  - [ ] Test nested booleans generate correct temp variables
  - [ ] Test `linear_extrude(height=10) { square([5,5]); }` -> `M.Manifold.extrude(...)`
  - [ ] Test `linear_extrude(height=10, twist=45)` -> correct `twistDegrees` param
  - [ ] Test `rotate_extrude(angle=180, $fn=64)` -> `M.Manifold.revolve(...)`
  - [ ] Test 2D shape (circle, square, polygon) converted to polygon array
  - [ ] Test `$fn = 64;` affects subsequent primitives
  - [ ] Test `$fn` clamped to 16-128 range
  - [ ] Test output includes `return` statement
  - [ ] Test output is valid JavaScript (parseable by `new Function()`)
  - [ ] Test output uses only `M` variable (no undefined references)
- **Estimated Complexity**: Large

### Task 4.2: Implement Transpiler [CRITICAL-PATH]
- **Type**: Implementation
- **Parallelizable**: No (depends on Task 4.1)
- **File**: `src/openscad/Transpiler.ts`
- **Description**: Implement code generator that converts AST to Manifold JavaScript.
- **Acceptance Criteria**:
  - [ ] All tests from Task 4.1 pass
  - [ ] `transpile(ast: ProgramNode, options?: TranspileOptions): string` exported
  - [ ] `transpileOpenSCAD(source: string, options?: TranspileOptions): string` convenience function exported (parses + transpiles)
  - [ ] `TranspileOptions` includes `{ defaultFn?: number }` (default 32)
  - [ ] Generated code uses unique temp variable names (`_v1`, `_v2`, etc.)
  - [ ] `$fn` context tracked and passed to primitives
  - [ ] 2D shapes converted to polygon point arrays
  - [ ] Boolean operations combine children correctly
  - [ ] Transforms chain in correct order
  - [ ] Final result assigned and returned
  - [ ] Output validated with `new Function()` before returning
  - [ ] `OpenSCADTranspileError` thrown for invalid AST states
- **Estimated Complexity**: Large

---

## Phase 5: Integration [SEQUENTIAL]

### Task 5.1: Write Integration Tests [BLOCKER]
- **Type**: Test
- **Parallelizable**: No (depends on Task 4.2)
- **File**: `src/openscad/__tests__/integration.test.ts`
- **Description**: End-to-end tests that verify OpenSCAD -> Manifold JavaScript -> actual Manifold execution.
- **Acceptance Criteria**:
  - [ ] Test simple cube creates valid Manifold with correct bounding box
  - [ ] Test difference creates valid Manifold with hole
  - [ ] Test linear_extrude creates valid 3D from 2D
  - [ ] Test rotate_extrude creates valid revolved solid
  - [ ] Test complex nested example produces valid geometry
  - [ ] Test error context suitable for AI retry (includes line/column, suggestion)
  - [ ] Test generated code uses only available worker context variables
  - [ ] Test generated code executes in same sandbox as worker
  - [ ] Tests use real Manifold-3D (via test setup)
  - [ ] Test `$fn` actually affects segment count (visible in mesh vertex count)
- **Estimated Complexity**: Medium

### Task 5.2: Create Public Exports (index.ts)
- **Type**: Implementation
- **Parallelizable**: No (depends on Task 4.2)
- **File**: `src/openscad/index.ts`
- **Description**: Create public API exports for the transpiler module.
- **Acceptance Criteria**:
  - [ ] Export `transpileOpenSCAD` function
  - [ ] Export `parse` function (for advanced usage)
  - [ ] Export `OpenSCADError`, `OpenSCADLexError`, `OpenSCADParseError`, `OpenSCADTranspileError`
  - [ ] Export `TranspileOptions` type
  - [ ] Export key AST types for type-checking
  - [ ] No internal implementation details exported
- **Estimated Complexity**: Small

### Task 5.3: Create OpenSCAD Prompt Template
- **Type**: Implementation
- **Parallelizable**: No (depends on Task 5.2)
- **File**: `src/prompts/openscadBuilder.prompt.md`
- **Description**: Create AI prompt template for OpenSCAD code generation, parallel to existing `manifoldBuilder.prompt.md`.
- **Acceptance Criteria**:
  - [ ] Clear task description for AI
  - [ ] Complete list of SUPPORTED operations with syntax examples
  - [ ] Explicit "NOT SUPPORTED" section listing forbidden features
  - [ ] Examples of correct usage for each primitive
  - [ ] Examples of correct usage for transforms and booleans
  - [ ] Examples of linear_extrude and rotate_extrude
  - [ ] `$fn` usage guidelines (16-128 range)
  - [ ] Instructions for parameter extraction (same format as manifold prompt)
  - [ ] JSON response format matching existing schema
  - [ ] Error recovery hints for common mistakes
  - [ ] No references to Manifold-3D API (AI generates OpenSCAD only)
- **Estimated Complexity**: Medium

### Task 5.4: Integrate Transpiler with Service
- **Type**: Implementation
- **Parallelizable**: No (depends on Task 5.3)
- **File**: `src/services/imageToGeometryService.ts` (modify)
- **Description**: Integrate OpenSCAD transpiler into the geometry service with format selection.
- **Acceptance Criteria**:
  - [ ] Add `OutputFormat` type: `'manifold' | 'openscad'`
  - [ ] Add format parameter to `createImageToGeometryService`
  - [ ] Load correct prompt template based on format
  - [ ] For OpenSCAD format: transpile before JavaScript validation
  - [ ] Parse errors trigger retry with `OpenSCADParseError.toRetryContext()`
  - [ ] Transpile errors handled similarly to parse errors
  - [ ] Retry logic unchanged (still MAX_RETRIES = 2)
  - [ ] Final output to worker is always valid Manifold JavaScript
  - [ ] Logging distinguishes between OpenSCAD parse and transpile phases
  - [ ] Existing Manifold format behavior unchanged (backward compatible)
- **Estimated Complexity**: Medium

### Task 5.5: Add Service Integration Tests
- **Type**: Test
- **Parallelizable**: No (depends on Task 5.4)
- **File**: `src/services/imageToGeometryService.test.ts` (modify)
- **Description**: Add tests for OpenSCAD format in the geometry service.
- **Acceptance Criteria**:
  - [ ] Test OpenSCAD format produces valid Manifold JavaScript output
  - [ ] Test parse error triggers retry with context
  - [ ] Test transpile error triggers retry with context
  - [ ] Test max retries respected for OpenSCAD errors
  - [ ] Test Manifold format unchanged (regression)
  - [ ] Mock AI responses with valid and invalid OpenSCAD
- **Estimated Complexity**: Small

---

## 7. Risk Considerations

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| AI generates unsupported OpenSCAD features | High | Medium | Strong "NOT SUPPORTED" list in prompt; clear parse errors for retry |
| Complex nested transformations have wrong order | Medium | High | Extensive test suite for transform chaining |
| Polygon winding order issues | Low | Medium | Test with Manifold validation; document expected winding |
| 2D shape to polygon conversion errors | Medium | Medium | Test each 2D shape type independently |
| $fn context not propagated correctly | Medium | Medium | Track $fn in transpiler state; test segment counts |
| Parse errors not actionable for AI | Medium | High | Include code snippet, line/column, expected tokens in error context |
| Generated JavaScript has syntax errors | Low | High | Validate with `new Function()` before returning |

---

## 8. File Structure Summary

```
src/openscad/
  index.ts              # Public exports
  types.ts              # Token, AST types (Phase 1)
  errors.ts             # Error classes (Phase 1)
  Lexer.ts              # Tokenizer (Phase 2)
  Parser.ts             # Recursive descent parser (Phase 3)
  Transpiler.ts         # Code generator (Phase 4)
  __tests__/
    Lexer.test.ts       # Phase 2
    Parser.test.ts      # Phase 3
    Transpiler.test.ts  # Phase 4
    integration.test.ts # Phase 5

src/prompts/
  openscadBuilder.prompt.md  # New prompt template (Phase 5)

src/services/
  imageToGeometryService.ts  # Modified for format selection (Phase 5)
```

---

## 9. Estimated Timeline

| Phase | Tasks | Estimated Time | Dependencies |
|-------|-------|----------------|--------------|
| Phase 1 | 1.1, 1.2 | 1-2 hours | None |
| Phase 2 | 2.1, 2.2 | 2-3 hours | Phase 1 |
| Phase 3 | 3.1, 3.2 | 4-5 hours | Phase 2 |
| Phase 4 | 4.1, 4.2 | 4-5 hours | Phase 3 |
| Phase 5 | 5.1-5.5 | 3-4 hours | Phase 4 |
| **Total** | | **14-19 hours** | |

---

## 10. Success Metrics

1. **All tests pass**: 100% of defined acceptance criteria verified
2. **AI generates valid OpenSCAD**: Prompt template enables consistent code generation
3. **Parse errors actionable**: AI successfully fixes errors after retry with context
4. **Worker unchanged**: Existing Manifold workflow unaffected
5. **No regressions**: Existing tests continue to pass

---

## 11. Post-Implementation Considerations

After implementation is complete:

1. **Collect AI Generation Metrics**: Track success/retry rates for OpenSCAD vs Manifold formats
2. **Tune Prompt Template**: Adjust based on common AI mistakes
3. **Consider Format Auto-Selection**: Based on model capabilities or user preference
4. **Expand Supported Subset**: If demand exists, consider adding more OpenSCAD features

---

**DO NOT COMMIT THIS PLAN FILE**
